"use strict";(self["webpackChunke_commerce_front"]=self["webpackChunke_commerce_front"]||[]).push([[198],{7198:function(t,a,e){e.r(a),e.d(a,{default:function(){return q}});var r=e(3396),i=e(7139);const o={class:"container editusercontent w-50"},s=(0,r._)("div",{class:"tabs d-flex"},[(0,r._)("a",{class:"tab-item",href:"/user"}," 個人資訊 "),(0,r._)("a",{class:"tab-item active",href:"#"},"我的訂單")],-1),l={class:"container mt-4"},c=["onClick"],n={class:"button-text"},d={key:0},h=(0,r._)("h3",null,"訂單詳情",-1),g={class:"container d-flex flex-column"},m=(0,r._)("span",{class:"item_title"},"所有商品",-1),u={class:"d-flex justify-content-center"},p={class:"data-imgitem"},_=["src"],v={class:"row"},w={class:"row"},f={class:"item_title"};function y(t,a,e,y,T,k){const C=(0,r.up)("Navbar");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(C,{cartTotal:T.cartTotal},null,8,["cartTotal"]),(0,r._)("div",o,[s,(0,r._)("div",l,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(T.orderdata,((t,a)=>((0,r.wg)(),(0,r.iD)("div",{key:a},[(0,r._)("span",{onClick:t=>k.toggleOrder(a),class:"btn collapse_button"},[(0,r._)("span",n,"訂單編號 "+(0,i.zw)(t.orderid),1),(0,r._)("i",{class:(0,i.C_)(["fa",{"fa-chevron-down":T.activeOrder===a,"fa-chevron-up":T.activeOrder!==a}])},null,2)],8,c),T.activeOrder===a?((0,r.wg)(),(0,r.iD)("div",d,[h,(0,r._)("div",g,[m,(0,r._)("div",u,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(T.imagelist[a],((t,e)=>((0,r.wg)(),(0,r.iD)("div",p,[(0,r._)("img",{src:t,alt:""},null,8,_),(0,r._)("span",null,(0,i.zw)(T.namelist[a][e]),1),(0,r._)("div",v," 數量:"+(0,i.zw)(T.quantitylist[a][e]),1),(0,r._)("div",w," 價格: "+(0,i.zw)(T.pricelist[a][e]),1)])))),256))])]),(0,r._)("span",f,"總金額:"+(0,i.zw)(T.orderdata[0].totalamount),1)])):(0,r.kq)("",!0)])))),128))])])],64)}e(7658);var T=e(4161),k=e(2492),C=e.n(k),O=e(971),S={name:"HomeView",components:{Navbar:O.Z},data(){return{username:" ",email:"",address:"",cellphone:"",activeTab:"User",cartTotal:0,activeOrder:0,orderdata:this.orderdata,imagelist:[],namelist:[],pricelist:[],quantitylist:[]}},methods:{toggleOrder(t){this.activeOrder===t?this.activeOrder=null:this.activeOrder=t},async getOrder(){console.log("http://localhost:3000/api/admin/order/");const t=await T.Z.get(`http://localhost:3000/api/admin/order/${localStorage.id}`);this.orderdata=t.data.data,console.log(this.orderdata),console.log(this.orderdata),console.log(this.orderdata),this.imagelist=this.orderdata.map(((t,a)=>t.image.split(","))),this.namelist=this.orderdata.map(((t,a)=>t.productname.split(","))),this.pricelist=this.orderdata.map(((t,a)=>t.itemprice.split(","))),this.quantitylist=this.orderdata.map(((t,a)=>t.quantity_array.split(","))),console.log(this.orderdata),console.log("imagelist:",this.imagelist),console.log(" namelist:",this.namelist),this.$emit("cartTotal",this.orderdata)},async getCart(){console.log(localStorage.email),console.log(localStorage);try{const t=await T.Z.get(`http://localhost:3000/api/admin/userCart/${localStorage.email}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data;this.cartProduct=a,localStorage.cart=a.length,this.updateCartTotal(this.cartTotal),this.cartTotal=t.data.length,this.cartTotal=t.data.reduce(((t,a)=>t+a.quantity),0)}catch(t){console.error("Login error:",t)}},logout(){localStorage.clear(),console.log(localStorage),this.$router.push("/login"),C().fire({title:"已登出",icon:"success",timer:2e3,timerProgressBar:!0})},updateCartTotal(t){this.cartTotal=t},async getUserInfo(){try{const t=await T.Z.get("http://localhost:3000/api/admin/login",{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data.data;console.log(a),this.username=a.user,this.email=a.email,this.address=a.address,this.cellphone=a.cellphone}catch(t){console.error("Login error:",t),this.$router.push("/login")}}},async getOrder(){console.log(this.orderdata),this.imagelist=this.orderdata.map(((t,a)=>t.image.split(","))),this.namelist=this.orderdata.map(((t,a)=>t.productname.split(","))),this.pricelist=this.orderdata.map(((t,a)=>t.itemprice.split(","))),this.quantitylist=this.orderdata.map(((t,a)=>t.quantity_array.split(","))),console.log(this.orderdata),console.log("imagelist:",this.imagelist),console.log(" namelist:",this.namelist),this.$emit("cartTotal",this.orderdata)},async getCart(){try{const t=await T.Z.get(`http://localhost:3000/api/admin/userCart/${localStorage.email}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data;this.cartProduct=a,this.cartTotal=t.data.reduce(((t,a)=>t+a.quantity),0),localStorage.cart=this.cartTotal}catch(t){console.error("Login error:",t),this.showlogin(),this.$router.push("/login")}},created(){this.getUserInfo(),this.getCart(),this.getOrder()}},b=e(89);const $=(0,b.Z)(S,[["render",y]]);var q=$}}]);
//# sourceMappingURL=198.808a43c1.js.map