"use strict";(self["webpackChunke_commerce_front"]=self["webpackChunke_commerce_front"]||[]).push([[519],{3519:function(t,a,e){e.r(a),e.d(a,{default:function(){return D}});var r=e(3396),i=e(7139);const s={class:"container editusercontent w-50"},o=(0,r._)("div",{class:"tabs d-flex"},[(0,r._)("a",{class:"tab-item",href:"/user"}," 個人資訊 "),(0,r._)("a",{class:"tab-item active",href:"#"},"我的訂單")],-1),l={class:"container mt-4"},c=["onClick"],n={class:"button-text"},d={key:0},h=(0,r._)("h3",null,"訂單詳情",-1),g={class:"container d-flex flex-column"},m={key:0,class:"item_title"},u={key:1,class:"item_title"},p=(0,r._)("span",{class:"item_title"},"所有商品",-1),_={class:"d-flex justify-content-center"},y={class:"data-imgitem"},v=["src"],w={class:"row"},f={class:"row"},T={class:"item_title"};function k(t,a,e,k,C,O){const S=(0,r.up)("Navbar");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(S,{cartTotal:C.cartTotal},null,8,["cartTotal"]),(0,r._)("div",s,[o,(0,r._)("div",l,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(C.orderdata,((t,a)=>((0,r.wg)(),(0,r.iD)("div",{key:a},[(0,r._)("span",{onClick:t=>O.toggleOrder(a),class:"btn collapse_button"},[(0,r._)("span",n,"訂單編號 "+(0,i.zw)(t.orderid),1),(0,r._)("i",{class:(0,i.C_)(["fa",{"fa-chevron-down":C.activeOrder===a,"fa-chevron-up":C.activeOrder!==a}])},null,2)],8,c),C.activeOrder===a?((0,r.wg)(),(0,r.iD)("div",d,[h,(0,r._)("div",g,[t.ispay?((0,r.wg)(),(0,r.iD)("span",m,"訂單狀態 已付款")):((0,r.wg)(),(0,r.iD)("span",u,"訂單狀態：尚未付款")),p,(0,r._)("div",_,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(C.imagelist[a],((t,e)=>((0,r.wg)(),(0,r.iD)("div",y,[(0,r._)("img",{src:t,alt:""},null,8,v),(0,r._)("span",null,(0,i.zw)(C.namelist[a][e]),1),(0,r._)("div",w," 數量:"+(0,i.zw)(C.quantitylist[a][e]),1),(0,r._)("div",f," 價格: "+(0,i.zw)(C.pricelist[a][e]),1)])))),256))])]),(0,r._)("span",T,"總金額:"+(0,i.zw)(t.totalamount),1)])):(0,r.kq)("",!0)])))),128))])])],64)}e(7658);var C=e(4161),O=e(2492),S=e.n(O),b=e(8565),$={name:"HomeView",components:{Navbar:b.Z},data(){return{username:" ",email:"",address:"",cellphone:"",activeTab:"User",cartTotal:0,activeOrder:0,orderdata:this.orderdata,imagelist:[],namelist:[],pricelist:[],quantitylist:[],ispay:!1}},methods:{toggleOrder(t){this.activeOrder===t?this.activeOrder=null:this.activeOrder=t},async getOrder(){console.log("http://localhost:3000/api/admin/order/");const t=await C.Z.get(`http://localhost:3000/api/admin/order/${localStorage.id}`);this.orderdata=t.data.data,console.log(this.orderdata),console.log(this.orderdata),console.log(this.orderdata),this.imagelist=this.orderdata.map(((t,a)=>t.image.split(","))),this.namelist=this.orderdata.map(((t,a)=>t.productname.split(","))),this.pricelist=this.orderdata.map(((t,a)=>t.itemprice.split(","))),this.quantitylist=this.orderdata.map(((t,a)=>t.quantity_array.split(","))),console.log(this.orderdata),console.log("imagelist:",this.imagelist),console.log(" namelist:",this.namelist),this.$emit("cartTotal",this.orderdata)},async getCart(){console.log(localStorage.email),console.log(localStorage);try{const t=await C.Z.get(`http://localhost:3000/api/admin/userCart/${localStorage.email}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data;this.cartProduct=a,localStorage.cart=a.length,this.updateCartTotal(this.cartTotal),this.cartTotal=t.data.length,this.cartTotal=t.data.reduce(((t,a)=>t+a.quantity),0)}catch(t){console.error("Login error:",t)}},logout(){localStorage.clear(),console.log(localStorage),this.$router.push("/login"),S().fire({title:"已登出",icon:"success",timer:2e3,timerProgressBar:!0})},updateCartTotal(t){this.cartTotal=t},async getUserInfo(){try{const t=await C.Z.get("http://localhost:3000/api/admin/login",{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data.data;console.log(a),this.username=a.user,this.email=a.email,this.address=a.address,this.cellphone=a.cellphone}catch(t){console.error("Login error:",t),this.$router.push("/login")}}},async getOrder(){console.log(this.orderdata),this.imagelist=this.orderdata.map(((t,a)=>t.image.split(","))),this.namelist=this.orderdata.map(((t,a)=>t.productname.split(","))),this.pricelist=this.orderdata.map(((t,a)=>t.itemprice.split(","))),this.quantitylist=this.orderdata.map(((t,a)=>t.quantity_array.split(","))),console.error(this.orderdata[0]),this.ispay=this.orderdata.ispay,console.log(this.orderdata),console.log("imagelist:",this.imagelist),console.log(" namelist:",this.namelist),this.$emit("cartTotal",this.orderdata)},async getCart(){try{const t=await C.Z.get(`http://192.168.68.112:3000/api/admin/userCart/${localStorage.email}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),a=t.data;this.cartProduct=a,this.cartTotal=t.data.reduce(((t,a)=>t+a.quantity),0),localStorage.cart=this.cartTotal}catch(t){console.error("Login error:",t),this.showlogin(),this.$router.push("/login")}},created(){this.getUserInfo(),this.getCart(),this.getOrder()}},q=e(89);const z=(0,q.Z)($,[["render",k]]);var D=z}}]);
//# sourceMappingURL=519.dfd7fb98.js.map