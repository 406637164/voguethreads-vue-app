"use strict";(self["webpackChunke_commerce_front"]=self["webpackChunke_commerce_front"]||[]).push([[464],{2464:function(t,e,a){a.r(e),a.d(e,{default:function(){return W}});var l=a(3396),o=a(7139);const i={class:"position-relative content"},c={class:"container"},r={class:"d-flex"},s={class:"product-container"},n={class:"item-lists"},u=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",{class:"item_detail"},"商品"),(0,l._)("th",{class:"price"},"單價"),(0,l._)("th",{class:"count"},"數量"),(0,l._)("th",{class:"amount",colspan:"2"},"金額"),(0,l._)("th",{class:"operate"})])],-1),d={class:"scrollable-tbody"},h={class:"item_detail"},m=["href"],_=["src"],p={class:"name"},g={class:"price"},f={class:"count"},w=["onClick"],b=["onClick"],k={class:"amount"},y={class:"operate"},C=["onClick"],v=(0,l._)("i",{class:"bx bx-x"},null,-1),T=[v],x={class:"checkout"},q=(0,l._)("span",{class:"title"},"商品清單",-1),z=(0,l._)("i",{class:"bx bxs-t-shirt",style:{color:"#c8815f"}},null,-1),P={class:"totals"},B={class:"d-flex detailtitle"},$=(0,l._)("div",null,[(0,l._)("i",{class:"bx bxs-wallet"}),(0,l.Uk)(" 總計")],-1),S=(0,l._)("footer",{class:"footer"},[(0,l._)("p",null,"© 2023 Your Website. All rights reserved.")],-1);function Z(t,e,a,v,Z,A){const D=(0,l.up)("Navbar");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(D,{cartTotal:Z.cartTotal},null,8,["cartTotal"]),(0,l._)("div",i,[(0,l._)("div",c,[(0,l._)("h4",null,"共"+(0,o.zw)(Z.cartTotal)+"項商品",1),(0,l._)("div",r,[(0,l._)("div",s,[(0,l._)("table",n,[u,(0,l._)("tbody",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Z.cartProduct,((t,e)=>((0,l.wg)(),(0,l.iD)("tr",{key:t.name},[(0,l._)("td",h,[(0,l._)("a",{href:`/product/${t.name}`},[(0,l._)("img",{src:t.image,alt:""},null,8,_),(0,l._)("div",p,[(0,l._)("span",null,(0,o.zw)(t.name),1)])],8,m)]),(0,l._)("td",g,(0,o.zw)(t.price),1),(0,l._)("td",f,[(0,l._)("button",{class:"btn dels",onClick:a=>A.reduceitem(t,e)}," - ",8,w),(0,l.Uk)(" "+(0,o.zw)(t.quantity)+" ",1),(0,l._)("button",{class:"btn adds",onClick:a=>A.additem(t,e)}," + ",8,b)]),(0,l._)("td",k,(0,o.zw)(t.price*t.quantity),1),(0,l._)("td",y,[(0,l._)("button",{class:"btn btn-outline-danger btn-sm del",onClick:a=>A.deleteitem(t,e)},T,8,C)])])))),128))])])]),(0,l._)("div",x,[q,(0,l._)("ol",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(Z.cartProduct,((t,e)=>((0,l.wg)(),(0,l.iD)("li",{key:t.name,class:"d-flex detailtitle"},[(0,l._)("div",null,[z,(0,l.Uk)(" "+(0,o.zw)(t.name),1)]),(0,l._)("div",null,"x "+(0,o.zw)(t.quantity),1)])))),128))]),(0,l._)("ul",P,[(0,l._)("li",B,[$,(0,l._)("div",null,[(0,l._)("span",null,"共 NT "+(0,o.zw)(A.totalPrice)+"元",1)])])]),(0,l._)("button",{id:"checkout",onClick:e[0]||(e[0]=t=>A.checkout(Z.cartProduct))},"結帳")])])])]),S],64)}a(7658);var A=a(680),D=a(2492),H=a.n(D),N=a(4161),Y=a(971),I={name:"HomeView",components:{Navbar:Y.Z},data(){return{cartProduct:[],itemcount:0,cartTotal:0,itemtotal:0}},methods:{checkout(t){console.log(t),console.log(t),0!=t.length?(A.Z.set("cartProduct",JSON.stringify(t)),this.$router.push({path:"/order"})):H().fire({position:"center",icon:"error",title:"請先選購商品",showConfirmButton:!1,timer:1500})},async getCart(t){console.log(localStorage);try{const t=await N.Z.get(`http://localhost:3000/api/admin/userCart/${localStorage.email}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}),e=t.data;console.log(e),this.cartProduct=e,this.cartTotal=t.data.length,this.cartTotal=t.data.reduce(((t,e)=>t+e.quantity),0)}catch(e){console.error("Login error:",e),this.showlogin(),this.$router.push("/login")}},async additem(t){await N.Z.patch("http://localhost:3000/api/admin/adduserCartItem",{cartitemid:t.cartitemid},{headers:{Authorization:`Bearer ${localStorage.token}`}});this.itemcount=t.quantity,t.quantity++,this.cartTotal++,console.log(this.cartTotal)},async reduceitem(t,e){await N.Z.patch("http://localhost:3000/api/admin/reduceuserCartItem",{cartitemid:t.cartitemid},{headers:{Authorization:`Bearer ${localStorage.token}`}});this.itemcount=t.quantity,this.itemcount>1?(this.itemcount--,t.quantity--,this.cartTotal--):this.itemcount<=1&&this.deleteitem(t,e,1)},async deleteitem(t,e,a){H().fire({title:"確認刪除此商品?",showCancelButton:!0,confirmButtonText:"是",cancelButtonText:"否"}).then((a=>{a.isConfirmed&&(1==t.quantity?this.cartTotal--:t.quantity>=1&&(this.cartTotal-=t.quantity),H().fire("刪除成功","","success"),this.cartProduct.splice(e,1),N.Z.delete(`http://localhost:3000/api/admin/deleteuserCartItem/${t.cartitemid}`,{headers:{Authorization:`Bearer ${localStorage.token}`}}))}))},showlogin(){H().fire({position:"center",icon:"error",title:"請先登入會員",showConfirmButton:!1,timer:1500})}},computed:{totalPrice(){return this.cartProduct.reduce(((t,e)=>t+e.price*e.quantity),0)}},created(){this.getCart()}},U=a(89);const K=(0,U.Z)(I,[["render",Z]]);var W=K}}]);
//# sourceMappingURL=464.3819d657.js.map